<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tuition Fee Calculator</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f9f9fb;
      padding: 40px 20px;
      max-width: 700px;
      margin: auto;
      color: #333;
    }
    h2 { text-align: center; margin-bottom: 30px; color: #2c3e50; }
    form {
      background: #fff; padding: 25px; border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    label { font-weight: bold; margin-top: 10px; display: block; }
    input, select, button {
      width: 100%; padding: 10px; margin-top: 5px;
      border: 1px solid #ccc; border-radius: 8px; font-size: 16px;
    }
    button {
      background-color: #2c3e50; color: white; border: none;
      cursor: pointer; margin-top: 20px;
    }
    button:hover { background-color: #1a242f; }
    .results, .templates {
      margin-top: 30px; background-color: #ecf0f1; padding: 20px;
      border-radius: 12px; box-shadow: inset 0 0 5px rgba(0,0,0,0.05);
    }
    .results h3, .templates h3 { margin-top: 0; color: #2c3e50; }
  </style>
</head>
<body>
  <h2>Tuition Fee Calculator</h2>
  <form id="feeForm">
    <label for="startDate">Start Date</label>
    <input type="date" id="startDate" required>

    <label for="monthlyFee">Monthly Fee (£)</label>
    <input type="number" id="monthlyFee" value="100" required>

    <label for="bookFee">Book Fee (£)</label>
    <input type="number" id="bookFee" value="45" required>

    <label for="saturdayHours">Saturday Hours</label>
    <input type="number" id="saturdayHours" step="0.1" value="2" required>

    <label for="sundayHours">Sunday Hours</label>
    <input type="number" id="sundayHours" step="0.1" value="1" required>

    <label for="wednesdayHours">Wednesday Hours</label>
    <input type="number" id="wednesdayHours" step="0.1" value="1.5" required>

    <label for="days">Select Tuition Days</label>
    <select id="days" required>
      <option value="6">Saturday Only</option>
      <option value="0">Sunday Only</option>
      <option value="3">Wednesday Only</option>
      <option value="weekend">Saturday and Sunday</option>
      <option value="all">Saturday, Sunday and Wednesday</option>
    </select>

    <label for="studentName">Student Name</label>
    <input type="text" id="studentName" placeholder="e.g., John Smith" required>

    <label for="yearGroup">Year Group</label>
    <input type="text" id="yearGroup" placeholder="e.g., Year 5" required>

    <button type="submit">Calculate</button>
  </form>

  <div class="results" id="results" style="display: none;">
    <h3>Results</h3>
    <p><strong>Tuition One-Off Fee:</strong> £<span id="tuitionOneOff"></span></p>
    <p><strong>Publication One-Off Fee:</strong> £<span id="publicationOneOff"></span></p>
    <p><strong>Tuition Direct Debit:</strong> £<span id="tuitionDD"></span></p>
    <p><strong>Publication Direct Debit:</strong> £<span id="publicationDD"></span></p>
  </div>

  <script src="https://js.jotform.com/JotFormCustomWidget.min.js"></script>
  <script>
    // Store latest calc result so widget can send something
    window._latestResult = {};

    document.getElementById('feeForm').addEventListener('submit', function(event) {
      event.preventDefault();

      const startDate = new Date(document.getElementById('startDate').value);
      const monthlyFee = parseFloat(document.getElementById('monthlyFee').value);
      const bookFee = parseFloat(document.getElementById('bookFee').value);
      const saturdayHours = parseFloat(document.getElementById('saturdayHours').value);
      const sundayHours = parseFloat(document.getElementById('sundayHours').value);
      const wednesdayHours = parseFloat(document.getElementById('wednesdayHours').value);
      const selectedDay = document.getElementById('days').value;
      const studentName = document.getElementById('studentName').value;
      const yearGroup = document.getElementById('yearGroup').value;

      let totalWeeklyHours = 0;
      if (selectedDay === '6') totalWeeklyHours = saturdayHours;
      else if (selectedDay === '0') totalWeeklyHours = sundayHours;
      else if (selectedDay === '3') totalWeeklyHours = wednesdayHours;
      else if (selectedDay === 'weekend') totalWeeklyHours = saturdayHours + sundayHours;
      else if (selectedDay === 'all') totalWeeklyHours = saturdayHours + sundayHours + wednesdayHours;

      const hourlyRate = (monthlyFee / (totalWeeklyHours * 4));
      const tuitionDD = monthlyFee * 0.6;
      const publicationDD = monthlyFee * 0.4;
      const tuitionOneOff = (bookFee + hourlyRate * totalWeeklyHours).toFixed(2);

      document.getElementById('tuitionOneOff').innerText = tuitionOneOff;
      document.getElementById('publicationOneOff').innerText = bookFee.toFixed(2);
      document.getElementById('tuitionDD').innerText = tuitionDD.toFixed(2);
      document.getElementById('publicationDD').innerText = publicationDD.toFixed(2);

      document.getElementById('results').style.display = 'block';

      // Save something for Jotform
      window._latestResult = {
        tuitionOneOff,
        bookFee: bookFee.toFixed(2),
        tuitionDD: tuitionDD.toFixed(2),
        publicationDD: publicationDD.toFixed(2),
        student: studentName,
        yearGroup
      };
    });

    // ---- Widget SDK hooks ----
    function resize() {
      const h = document.documentElement.scrollHeight || document.body.scrollHeight || 300;
      JFCustomWidget.setHeight(h);
    }
    new (window.ResizeObserver||function(){return{observe(){}}})().observe?.(document.body);

    JFCustomWidget.subscribe("ready", resize);

    JFCustomWidget.subscribe("validate", function () {
      // Always pass validation
      JFCustomWidget.sendSubmit({ valid: true, value: JSON.stringify(window._latestResult || {}) });
    });

    JFCustomWidget.subscribe("submit", function () {
      // Always send a value, even if empty
      JFCustomWidget.sendSubmit({ value: JSON.stringify(window._latestResult || {}) });
    });
  </script>
</body>
</html>

